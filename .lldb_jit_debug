# LLDB script for debugging flaky JIT test
# Usage: lldb -s .lldb_jit_debug

# Load the test binary
target create target/debug/deps/facet_format_suite-ac9ac5c058233617

# Stop on all crash signals
process handle SIGSEGV --stop true --notify true
process handle SIGABRT --stop true --notify true
process handle SIGTRAP --stop true --notify true
process handle SIGBUS --stop true --notify true

# Break on Rust panic
breakpoint set -n rust_panic_with_hook

# Run the flaky test
run test_twitter::test_facet_format_jit_t1_deserialize --exact
