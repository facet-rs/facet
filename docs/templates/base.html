<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}{{ config.title }}{% endblock title %}</title>
    <meta name="description" content="{{ config.description }}">
    <link rel="stylesheet" href="{{ get_url(path='main.css') }}">
    <link rel="stylesheet" href="/pagefind/pagefind-ui.css">
    <link rel="icon" type="image/png" href="{{ get_url(path='favicon.png') }}">
    {% block head %}{% endblock head %}
</head>
<body>
    <nav class="site-nav">
        <a href="/" class="site-nav-brand">
            <img src="{{ get_url(path='favicon.png') }}" alt="" class="site-nav-logo">
            <span>facet</span>
        </a>
        <div class="site-nav-links">
            <a href="/learn" {% if current_path is starting_with("/learn") %}class="active"{% endif %}>Learn</a>
            <a href="/extend" {% if current_path is starting_with("/extend") %}class="active"{% endif %}>Extend</a>
            <a href="/contribute" {% if current_path is starting_with("/contribute") %}class="active"{% endif %}>Contribute</a>
        </div>
        <div id="search" class="site-nav-search"></div>
        <a href="https://github.com/facet-rs/facet" class="site-nav-github" title="GitHub">
            <svg viewBox="0 0 16 16" width="24" height="24" fill="currentColor">
                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
            </svg>
        </a>
    </nav>

    {% block body %}
    <div class="container">
        {% block content %}{% endblock content %}
    </div>
    {% endblock body %}

    <script src="/pagefind/pagefind-ui.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Build TOC from showcase scenario headers
        const toc = document.querySelector('.toc ul');
        const showcase = document.querySelector('.showcase');
        if (toc && showcase && toc.children.length === 0) {
            const headers = showcase.querySelectorAll('h3[id]');
            headers.forEach(function(h3) {
                const li = document.createElement('li');
                const a = document.createElement('a');
                a.href = '#' + h3.id;
                a.textContent = h3.textContent.replace(/^§/, '');
                li.appendChild(a);
                toc.appendChild(li);
            });
        }

        // Initialize Pagefind
        new PagefindUI({
            element: "#search",
            showSubResults: true,
            showImages: false,
            translations: {
                placeholder: "Search ⌘K"
            }
        });

        // Keyboard shortcuts for search
        function isInputElement(el) {
            const tagName = el.tagName.toLowerCase();
            return tagName === 'input' || tagName === 'textarea' || el.isContentEditable;
        }

        document.addEventListener('keydown', function(e) {
            const searchInput = document.querySelector('#search input');
            if (!searchInput) return;

            // Cmd+K or Ctrl+K
            if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
                e.preventDefault();
                searchInput.focus();
                searchInput.select();
                return;
            }
            // Slash when not in an input
            if (e.key === '/' && !isInputElement(e.target)) {
                e.preventDefault();
                searchInput.focus();
                searchInput.select();
            }
        });
    });
    </script>
</body>
</html>
