# facet-html-diff-wasm

WASM client for facet-html-diff - applies DOM patches in the browser.

## Overview

This crate compiles to WebAssembly and applies DOM patches generated by
`facet-html-diff` directly in the browser. It uses `web-sys` to manipulate
the live DOM, enabling efficient incremental updates without replacing
the entire document.

## Architecture

```text
Server (Rust)                          Browser (WASM)
─────────────                          ───────────────
old HTML ─┐                            
          ├─► diff_html() ─► patches ─────► apply_patches()
new HTML ─┘        │                              │
                   │                              ▼
            facet-html-diff              DOM mutations via web-sys
```

Patches follow [Chawathe edit script semantics][chawathe] - Insert and Move
operations displace existing nodes into slots rather than shifting siblings.
The DOM's `replaceChild` method provides atomic displacement, returning the
removed node for storage in the slot.

See [`cinereus/CHAWATHE_SEMANTICS.md`](../cinereus/CHAWATHE_SEMANTICS.md) for details.

[chawathe]: https://dl.acm.org/doi/10.1145/235968.233366

## Building

```bash
wasm-pack build --target web
```

## Testing

This crate is primarily used for testing that `facet-html-diff` generates correct
patches by verifying them against a real browser DOM via headless browser tests.
